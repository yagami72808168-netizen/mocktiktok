# 本地 TikTok 风视频播放器 — 完整 UI 详细说明与草图（高保真版）

> 目标：实现一个沉浸式、本地视频为主、按用户手动选择播放源、支持收藏夹/播放列表、无限循环、且交互复刻 TikTok 的本地播放器。界面可切换“沉浸模式”，支持双击局部放大 / 三击更大、长按点赞、右滑进入收藏夹主页（模仿用户主页），底部为三栏导航（占位 / 视频 / 设置）。

---

## 一、总体设计原则（Design Principles）
1. **沉浸感优先**：默认隐藏系统栏、ActionBar，视频占满全屏，交互以手势为核心。UI 元素透明、低对比，不打断观看体验。
2. **可控显隐**：通过顶部的“简洁/还原”按钮切换沉浸模式；点击任意屏幕角落短暂显示控制项。
3. **单手可操作**：主要操作（点赞/收藏/展开信息）集中在右侧竖列与底部中间区域，方便单手拇指操作。
4. **流畅体验**：尽量复用播放器（PlayerPool）、预加载下一条、无缝循环，滑动不卡顿。
5. **可拓展**：收藏夹、标签、备注、编辑等功能模块设计为可插拔的扩展模块。

---

## 二、配色与字体（建议）
- 背景：#000000（纯黑）
- 主要文字：#FFFFFF（白）
- 次要文字：#BDBDBD（灰）
- 强调色（交互控件/喜欢）：#FF2D55（鲜红）
- 按钮半透明背景：rgba(0,0,0,0.35)
- 字体：系统默认 + 中文使用 "Noto Sans CJK"（若无可用 Roboto + 宋体替代）
- 字号：标题 16sp、正文 14sp、元信息 12sp

---

## 三、整体页面架构（导航）
- 底部导航（固定）
  - 左：占位（朋友页）
  - 中：视频主界面（高亮）
  - 右：设置页
- 页面栈
  - MainActivity（承载底部导航 + Fragment 容器）
    - HomeFragment（视频流）
    - PlaceholderFragment（占位）
    - SettingsFragment（设置）
- 右滑手势（从 HomeFragment 向右）打开 CollectionProfileActivity（或 Fragment 的 full-screen 转场）

---

## 四、主播放页（Home / Video Player）详述

### 4.1 视觉布局（默认 UI 可见）
```
┌────────────────────────────────────────────┐
│ [搜索栏 🔍]                     [简洁/还原] │
├────────────────────────────────────────────┤
│                                            │
│              （全屏视频区 — cover裁剪）   │
│                                            │
│  ┌──────────────────────────────────────┐  │
│  │ 底部信息卡（左下）                     │  │
│  │ - 标题（1行）                          │  │
│  │ - 描述（最多2行，超出显示“展开”）     │  │
│  └──────────────────────────────────────┘  │
│                                            │
│                     右侧竖列按钮            │
│                 ❤️                         │
│                 120.3K                     │
│                 ⭐（收藏）                  │
│                 🔗（更多）                 │
│                                            │
└────────────────────────────────────────────┘

底部导航（常驻）
────────────────────────────────────────────
  ○ 占位（朋友页）      ● 视频      ○ 设置
────────────────────────────────────────────
```

### 4.2 主要组件说明
- **视频区（核心）**
  - 使用 `ExoPlayer`，渲染 `PlayerView`（使用 `resizeMode = ZOOM` / CENTER_CROP 效果）
  - 为了实现无缝滑动，使用 `RecyclerView` + `PagerSnapHelper`（每个 item 占满屏幕）
  - 每个 item 中维护对播放器的引用（由 PlayerPool 管理），在滑动时切换播放器绑定。

- **顶部搜索栏**
  - 可搜索本地视频（文件名/描述/标签/收藏夹）和收藏夹
  - 搜索建议采用即时过滤，不跳出当前沉浸状态（弹出模态 BottomSheet 展示搜索结果）

- **信息卡（左下）**
  - 标题（单行） + 描述（前两行）+ 展开按钮
  - 点击展开显示完整描述与额外操作（编辑、删除、复制路径）

- **右侧竖列按钮**
  - 风格：图标+小文字垂直排列，按钮间距 18-24dp
  - 动作：喜欢（长按触发）、收藏（点击弹出选择加入哪个收藏夹）、更多（打开操作表）
  - 点赞数实时动画增长（模拟数值）；当用户长按“点赞”时，数值逐步增加，按钮色彩过渡到强调色。

- **底部导航**
  - 常驻；在沉浸模式下自动隐藏（伴随淡出动画）

### 4.3 手势与交互细节
- **单击**：暂停 / 播放（中心触摸区）
- **双击**：局部放大（2x 或 1.5x，视视频分辨率与纵横比设定）
  - 动画：平滑缩放（200ms）、放大时中心以双击点为中心放大
  - 再次双击：还原到 fitCenter / CENTER_CROP
- **快速三击（3 taps within 400ms）**：放更大（例如 3x），超出则回到 2x
  - 放大上限根据视频清晰度限制，若清晰度不足则浮层提示“不建议放大”
- **放大状态下**：双击还原为默认比例；拖动可平移视频（边界有限制）
- **长按**：点赞（行为区别：长按触发喜欢并触发“数字递增与漂心动画”）；长按持续 600ms 触发
- **上/下 滑**：切换到下一/上一条（支持惯性滑动）
- **右滑**：进入收藏夹主页（用户主页样式）
- **向下拉**（在顶部）：刷新当前播放列表（仅在非沉浸模式或明显手势下允许）

### 4.4 状态与动画
- 切换视频：淡入淡出 120ms + preload next 500ms
- 加载状态：居中加载进度（圆环），避免遮挡主要信息
- 喜欢动画：心形缩放 + 飘心上浮 800ms
- 底部信息展开：从底部向上弹出卡片（Material BottomSheet 风格）

---

## 五、收藏夹 / 用户主页（右滑进入）
- **Header**：头像（可自定义）、收藏夹名称、说明文字（可编辑）
- **操作按钮**：播放全部、随机播放、编辑收藏夹、导出列表
- **下方卡片式视频列表**：每项显示封面（第一帧）、标题、前两行描述、时长和更多按钮；卡片高度建议 120-160dp
- **卡片交互**：点击卡片 → 在主播放页跳转到该视频并开始播放；长按卡片 → 弹出操作菜单（移出收藏夹、重命名、移动、设置为封面）

---

## 六、视频选择器（手动挑选播放源）
- 打开方式：从设置页或底部“播放源”入口进入
- 支持：多选、按文件夹筛选、按时长筛选（<30s, 30-120s, >120s）、按日期筛选
- 选择后：生成播放列表（可命名并保存为收藏夹）

---

## 七、设置页（右下）
- 自动播放声音（开启/关闭）
- 硬件解码优先
- 是否启用沉浸自动隐藏（开关）
- 放大阈值（最大放大倍数）
- 播放缓存大小上限
- 私密空间（密码/生物识别解锁）
- 数据导入导出（收藏夹 JSON）

---

## 八、可视化草图说明（High-level wireframes）
> 画布中已有线稿（wireframe），这里说明草图中的关键点以便开发对照实现。

1. **主播放页（默认）**
   - 顶部：搜索栏左对齐、右侧为“简洁/还原”小按钮
   - 屏幕主体：每个 RecyclerView item 为 FrameLayout，PlayerView 在底层，上面覆盖信息卡与交互按钮
   - 右侧竖列：垂直居中，图标大小 48dp，图标下方小字 12sp
   - 左下信息卡：背景半透明圆角矩形（12dp），内边距 12dp

2. **沉浸模式**
   - 顶部/底部元素淡出并移出屏幕（translateY）
   - 交互仍然可触达：短按任意角落可唤出一次性控制条

3. **用户主页（收藏夹）**
   - Header 区高度 160dp，左侧圆形头像，右侧为编辑按钮
   - 卡片列表竖向排列，卡片左侧固定封面 1:1 缩略图，右侧为文字和操作按钮

---

## 九、实现建议（Android 相关实现要点）
- 播放器与列表
  - `RecyclerView` + `PagerSnapHelper` 或 `ViewPager2`（建议 RecyclerView 更灵活）
  - `ExoPlayer` + `PlayerPool`（复用 N 个播放器，避免频繁创建）
  - 在 `onViewAttachedToWindow` 时绑定 player，`onViewDetachedFromWindow` 时释放绑定
  - 预加载下一条：在当前播放时准备下一个 item 的 mediaSource（但不 attach 到 view）

- 数据层
  - 使用 `Room` 保存视频元数据、收藏夹表、播放记录、喜欢数（本地模拟）
  - Repository 层负责文件扫描（可按需触发）、播放列表管理、收藏夹操作

- 手势
  - 使用 `GestureDetector` 与 `ScaleGestureDetector` 组合处理单击 / 双击 / 三击 / 长按 / 多点缩放
  - 自定义三击检测：记录短时间内的 tap 次数（400ms 窗口）

- 缩放与平移
  - 双击放大通过 `ObjectAnimator` 操作 `View` 的 `scaleX/scaleY` 与 `translationX/translationY`
  - 放大后限制平移边界（确保不出现黑边）

- 喜欢数模拟
  - 存本地初始基数（可随机），长按触发的喜欢行为增加本地值并做动画。
  - 为增强真实感，可在每次进入播放列表时用带噪声的增量模拟“自然增长”（例如 0~3 的微小随机数间隔性增加）

- 权限
  - 运行时请求 `READ_EXTERNAL_STORAGE`（Android 13 以下）或 `READ_MEDIA_VIDEO`（Android 13+）

---

## 十、无障碍与国际化
- 无障碍（Accessibility）
  - 所有按钮添加 `contentDescription`
  - 支持 TalkBack，双击/三击操作应保留备用按键（例如在右上角提供“放大”按钮）
- 国际化
  - 文本资源放入 `strings.xml`，支持中文/英文，可扩展

---

## 十一、交互流程图（简述）
1. 启动 → 默认进入 Home（视频播放）
2. 顶部搜索：查询后弹出 BottomSheet，选择结果替换当前播放列表
3. 底部导航：切换 Fragment（占位 / 视频 / 设置）
4. 右滑视频：转场动画进入收藏夹主页（可返回）
5. 长按视频喜欢：立即更新界面数字并记录入 Room
6. 双击 / 三击放大：变换缩放状态 -> 双击还原
7. 滑到底：自动循环到第一条（内部采用 position % size 映射）

---

## 十二、交付物（我已经把这些草图与说明加入到 Canvas）：
- 高保真 UI 说明文档（当前文档）
- Wireframe（线稿）已放入画布

如果你要我继续，我可以：
- 把主播放页做成**高保真原型图**（SVG/PNG 风格）
- 直接生成主播放页的 **XML 布局草稿**（可复制到 Android Studio）
- 写出 RecyclerView + ExoPlayer 的完整样例代码（Kotlin）

告诉我你下一步想要哪份交付物？

